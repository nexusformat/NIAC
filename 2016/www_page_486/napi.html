<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>4. NAPI: NeXus Application Programmer Interface (frozen) &#8212; NeXus Data Format 3.2 documentation</title>
    
    <link rel="stylesheet" href="_static/nxsphinx.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '3.2',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="search" type="application/opensearchdescription+xml"
          title="Search within NeXus Data Format 3.2 documentation"
          href="_static/opensearch.xml"/>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="copyright" title="Copyright" href="copyright.html" />
    <link rel="top" title="NeXus Data Format 3.2 documentation" href="contents.html" />
    <link rel="next" title="4.3.1. NAPI C and C++ Interface" href="napi-c.html" />
    <link rel="prev" title="3.3.3.12. NXspin_rotator" href="classes/contributed_definitions/NXspin_rotator.html" />
    <link href='http://fonts.googleapis.com/css?family=Open+Sans:300,400,700'
          rel='stylesheet' type='text/css' />
 
    <style type="text/css">
      table.right { float: right; margin-left: 20px; }
      table.right td { border: 1px solid #ccc; }
      
    </style>
    <script type="text/javascript">
      // intelligent scrolling of the sidebar content
      $(window).scroll(function() {
        var sb = $('.sphinxsidebarwrapper');
        var win = $(window);
        var sbh = sb.height();
        var offset = $('.sphinxsidebar').position()['top'];
        var wintop = win.scrollTop();
        var winbot = wintop + win.innerHeight();
        var curtop = sb.position()['top'];
        var curbot = curtop + sbh;
        // does sidebar fit in window?
        if (sbh < win.innerHeight()) {
          // yes: easy case -- always keep at the top
          sb.css('top', $u.min([$u.max([0, wintop - offset - 10]),
                                $(document).height() - sbh - 200]));
        } else {
          // no: only scroll if top/bottom edge of sidebar is at
          // top/bottom edge of window
          if (curtop > wintop && curbot > winbot) {
            sb.css('top', $u.max([wintop - offset - 10, 0]));
          } else if (curtop < wintop && curbot < winbot) {
            sb.css('top', $u.min([winbot - sbh - offset - 20,
                                  $(document).height() - sbh - 200]));
          }
        }
      });
    </script>

  </head>
  <body role="document">
<div class="pageheader">
  <ul>
    <li><a href="index.html">Home</a></li>
    <li><a href="user_manual.html">User Manual</a></li>
    <li><a href="ref_doc.html">Reference Documentation</a></li>
    <li><a href="https://github.com/nexusformat">NeXus Github</a></li>
  </ul>
  <div>
    <a href="index.html">
      <img src="_static/NeXus.png" alt="NeXus" />
    </a>
  </div>
</div>

    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="napi-c.html" title="4.3.1. NAPI C and C++ Interface"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="classes/contributed_definitions/NXspin_rotator.html" title="3.3.3.12. NXspin_rotator"
             accesskey="P">previous</a> |</li>
        <li><a href="index.html">NeXus Home</a>&nbsp;|</li>
        <li><a href="contents.html">Table of Contents</a> &raquo;</li>
 
      </ul>
    </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="contents.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">4. NAPI: NeXus Application Programmer Interface (frozen)</a><ul>
<li><a class="reference internal" href="#status">4.1. Status</a></li>
<li><a class="reference internal" href="#overview">4.2. Overview</a></li>
<li><a class="reference internal" href="#core-api">4.3. Core API</a></li>
<li><a class="reference internal" href="#utility-api">4.4. Utility API</a><ul>
<li><a class="reference internal" href="#list-of-f90-utility-routines">4.4.1. List of F90 Utility Routines</a></li>
</ul>
</li>
<li><a class="reference internal" href="#building-programs">4.5. Building Programs</a></li>
<li><a class="reference internal" href="#reporting-bugs-in-the-nexus-api">4.6. Reporting Bugs in the NeXus API</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="classes/contributed_definitions/NXspin_rotator.html"
                        title="previous chapter">3.3.3.12. NXspin_rotator</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="napi-c.html"
                        title="next chapter">4.3.1. NAPI C and C++ Interface</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/napi.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <div><input type="text" name="q" /></div>
      <div><input type="submit" value="Go" /></div>
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="napi-nexus-application-programmer-interface-frozen">
<span id="napi"></span><span id="index-0"></span><h1>4. NAPI: NeXus Application Programmer Interface (frozen)<a class="headerlink" href="#napi-nexus-application-programmer-interface-frozen" title="Permalink to this headline">¶</a></h1>
<div class="section" id="status">
<h2>4.1. Status<a class="headerlink" href="#status" title="Permalink to this headline">¶</a></h2>
<p>This application program interface (API) was developed to support the
reading and writing of NeXus files through unified function calls,
regardless of the physical data format (XML, HDF4, HDF5).</p>
<p>In the meantime it has been decided that active development of NeXus
definitions and tools will concentrate on HDF5
as the only supported physical data format.
It is expected that most application developers will use
standard HDF5 tools to read and write NeXus.
Two examples are provided in <a class="reference internal" href="examples/code_native.html#native-hdf5-examples"><span class="std std-ref">Example NeXus C programs using native HDF5 commands</span></a>.</p>
<p>Therefore, the decision has been taken to freeze the NAPI.
Maintenance is reduced to bug fixes.</p>
</div>
<div class="section" id="overview">
<h2>4.2. Overview<a class="headerlink" href="#overview" title="Permalink to this headline">¶</a></h2>
<p>The core routines have been written in C but wrappers are available for a
number of other languages including C++, Fortran 77, Fortran 90, Java,
Python and IDL. The API makes the reading and writing of NeXus files
transparent; the user doesn&#8217;t even need to know the underlying format when
reading a file since the API calls are the same.</p>
<p>More in-depth and up-to-date information about the NeXus Application
Programming Interface for the various language backends is available on-line
from <a class="reference external" href="http://download.nexusformat.org">http://download.nexusformat.org</a>.</p>
<p>The  NeXusIntern.pdf document
(<a class="reference external" href="https://github.com/nexusformat/code/blob/master/doc/api/NeXusIntern.pdf">https://github.com/nexusformat/code/blob/master/doc/api/NeXusIntern.pdf</a>) describes the
internal workings of the NeXus-API. You are very welcome to read it, but it
will not be of much use if all you want is to read and write files using the NAPI.</p>
<p>The NeXus Application Program Interface
call routines in the appropriate backend (HDF4, HDF5 or XML) to read and write files
with the correct structure. The API serves a number of purposes:</p>
<ol class="arabic simple">
<li>It simplifies the reading and writing of NeXus files.</li>
<li>It ensures a certain degree of compliance with the NeXus standard.</li>
<li>It hides the implementation details of the format.
In particular, the API can read and write HDF4, HDF5,
and XML files using the same routines.</li>
</ol>
</div>
<div class="section" id="core-api">
<span id="napi-core"></span><span id="index-1"></span><h2>4.3. Core API<a class="headerlink" href="#core-api" title="Permalink to this headline">¶</a></h2>
<p>The core API provides the basic routines for reading, writing
and navigating NeXus files. Operations are performed using a handle
that keeps a record of its current position in the file hierarchy.
All are read or write requests are then
implicitly performed on the currently <em>open</em> entity. This limits
number of parameters that need to be passed to API calls, at the
cost of forcing a certain mode of operation.
It is very similar
to navigating a directory hierarchy; NeXus
groups are the directories, which can contain data sets
and/or other directories.</p>
<p>The core API comprises the following functional groups:</p>
<ul class="simple">
<li>General initialization and shutdown:
opening and closing the file,
creating or opening an existing group or dataset,
and closing them.</li>
<li>Reading and writing data and attributes to previously
opened datasets.</li>
<li>Routines to obtain meta-data and to iterate over component
datasets and attributes.</li>
<li>Handling of linking and group hierarchy.</li>
<li>Routines to handle memory allocation. (Not required in all language bindings.)</li>
</ul>
<div class="toctree-wrapper compound">
<ul>
<li class="toctree-l1"><a class="reference internal" href="napi-c.html">4.3.1. NAPI C and C++ Interface</a></li>
<li class="toctree-l1"><a class="reference internal" href="napi-f77.html">4.3.2. NAPI Fortran 77 Interface</a></li>
<li class="toctree-l1"><a class="reference internal" href="napi-f90.html">4.3.3. NAPI Fortran 90 Interface</a></li>
<li class="toctree-l1"><a class="reference internal" href="napi-java.html">4.3.4. NAPI Java Interface</a><ul>
<li class="toctree-l2"><a class="reference internal" href="napi-java.html#acknowledgement">4.3.4.1. Acknowledgement</a></li>
<li class="toctree-l2"><a class="reference internal" href="napi-java.html#installation">4.3.4.2. Installation</a></li>
<li class="toctree-l2"><a class="reference internal" href="napi-java.html#running-programs-with-the-nexus-api-for-java">4.3.4.3. Running Programs with the NeXus API for Java</a></li>
<li class="toctree-l2"><a class="reference internal" href="napi-java.html#programming-with-the-nexus-api-for-java">4.3.4.4. Programming with the NeXus API for Java</a></li>
<li class="toctree-l2"><a class="reference internal" href="napi-java.html#data-writing-and-reading">4.3.4.5. Data Writing and Reading</a></li>
<li class="toctree-l2"><a class="reference internal" href="napi-java.html#inquiry-routines">4.3.4.6. Inquiry Routines</a></li>
<li class="toctree-l2"><a class="reference internal" href="napi-java.html#known-problems">4.3.4.7. Known Problems</a></li>
<li class="toctree-l2"><a class="reference internal" href="napi-java.html#on-line-documentation">4.3.4.8. On-line Documentation</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="napi-python.html">4.3.5. NAPI Python Interface</a></li>
<li class="toctree-l1"><a class="reference internal" href="napi-idl.html">4.3.6. NAPI IDL Interface</a></li>
</ul>
</div>
</div>
<div class="section" id="utility-api">
<span id="napi-utility"></span><h2>4.4. Utility API<a class="headerlink" href="#utility-api" title="Permalink to this headline">¶</a></h2>
<p>The NeXus F90 Utility API provides a number of routines that combine the
operations of various core API routines in order to simplify the reading
and writing of NeXus files. At present, they are only available as a
Fortran 90 module but a C version is in preparation.</p>
<p>The utility API comprises the following functional groups:</p>
<ul class="simple">
<li>Routines to read or write data.</li>
<li>Routines to find whether or not groups, data, or attributes exist, and to
find data with specific signal or axis attributes, i.e. to identify valid data or axes.</li>
<li>Routines to open other groups to which <code class="docutils literal"><span class="pre">NXdata</span></code> items are linked, and to return again.</li>
</ul>
<p class="rubric">line required for use with F90 API</p>
<p>Any program using the F90 Utility API needs to put
the following line near the top of the program:</p>
<div class="highlight-default"><div class="highlight"><pre><span class="n">use</span> <span class="n">NXUmodule</span>
</pre></div>
</div>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Do not put <code class="docutils literal"><span class="pre">USE</span></code> statements for both
<code class="docutils literal"><span class="pre">NXmodule</span></code> and <code class="docutils literal"><span class="pre">NXUmodule</span></code>.
The former is included in the latter</p>
</div>
<div class="section" id="list-of-f90-utility-routines">
<span id="napi-utilityroutines"></span><h3>4.4.1. List of F90 Utility Routines<a class="headerlink" href="#list-of-f90-utility-routines" title="Permalink to this headline">¶</a></h3>
<table border="1" class="docutils">
<colgroup>
<col width="35%" />
<col width="65%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">name</th>
<th class="head">description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td colspan="2">Reading and Writing</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal"><span class="pre">NXUwriteglobals</span></code></td>
<td>Writes all the valid global attributes of a file.</td>
</tr>
<tr class="row-even"><td><code class="docutils literal"><span class="pre">NXUwritegroup</span></code></td>
<td>Opens a group (creating it if necessary).</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal"><span class="pre">NXUwritedata</span></code></td>
<td>Opens a data item (creating it if necessary)
and writes data and its units.</td>
</tr>
<tr class="row-even"><td><code class="docutils literal"><span class="pre">NXUreaddata</span></code></td>
<td>Opens and reads a data item and its units.</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal"><span class="pre">NXUwritehistogram</span></code></td>
<td>Opens one dimensional data item
(creating it if necessary)
and writes histogram centers and their units.</td>
</tr>
<tr class="row-even"><td><code class="docutils literal"><span class="pre">NXUreadhistogram</span></code></td>
<td>Opens and reads a one dimensional data item and
converts it to histogram bin boundaries.</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal"><span class="pre">NXUsetcompress</span></code></td>
<td>Defines the compression algorithm and minimum
dataset size for subsequent write operations.</td>
</tr>
<tr class="row-even"><td colspan="2">Finding Groups, Data, and Attributes</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal"><span class="pre">NXUfindclass</span></code></td>
<td>Returns the name of a group of the specified
class if it is contained within the currently
open group.</td>
</tr>
<tr class="row-even"><td><code class="docutils literal"><span class="pre">NXUfinddata</span></code></td>
<td>Checks whether a data item of the specified name
is contained within the currently open group.</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal"><span class="pre">NXUfindattr</span></code></td>
<td>Checks whether the currently open data item has
the specified attribute.</td>
</tr>
<tr class="row-even"><td><code class="docutils literal"><span class="pre">NXUfindsignal</span></code></td>
<td>Searches the currently open group for a data item
with the specified <code class="docutils literal"><span class="pre">SIGNAL</span></code> attribute.</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal"><span class="pre">NXUfindaxis</span></code></td>
<td>Searches the currently open group for a data item
with the specified <code class="docutils literal"><span class="pre">AXIS</span></code> attribute.</td>
</tr>
<tr class="row-even"><td colspan="2">Finding Linked Groups</td>
</tr>
<tr class="row-odd"><td><code class="docutils literal"><span class="pre">NXUfindlink</span></code></td>
<td>Finds another link to the specified NeXus data
item and opens the group it is in.</td>
</tr>
<tr class="row-even"><td><code class="docutils literal"><span class="pre">NXUresumelink</span></code></td>
<td>Reopens the original group from which
<code class="docutils literal"><span class="pre">NXUfindlink</span></code> was used.</td>
</tr>
</tbody>
</table>
<p>Currently, the F90 utility API will only write character strings,
4-byte integers and reals, and 8-byte reals. It can read other
integer sizes into four-byte integers, but does not differentiate
between signed and unsigned integers.</p>
</div>
</div>
<div class="section" id="building-programs">
<span id="napi-building"></span><h2>4.5. Building Programs<a class="headerlink" href="#building-programs" title="Permalink to this headline">¶</a></h2>
<p>The install kit provides a utility call <code class="docutils literal"><span class="pre">nxbuild</span></code>
that can be used to build simple programs:</p>
<div class="highlight-default"><div class="highlight"><pre><span class="n">nxbuild</span> <span class="o">-</span><span class="n">o</span> <span class="n">test</span> <span class="n">test</span><span class="o">.</span><span class="n">c</span>
</pre></div>
</div>
<p>This script links in the various libraries for you and reading its
contents would provide the necessary information for creating a
separate Makefile. You can also use <code class="docutils literal"><span class="pre">nxbuild</span></code> with the
example files in the NeXus distribution kit which are installed into
<code class="docutils literal"><span class="pre">/usr/local/nexus/examples</span></code></p>
<p>Note that the executable name is important in this case as the test
program uses it internally to determine the <code class="docutils literal"><span class="pre">NXACC_CREATE*</span></code>
argument to pass to <code class="docutils literal"><span class="pre">NXopen</span></code>.</p>
<p class="rubric">building and running a simple NeXus program</p>
<div class="highlight-default"><div class="highlight"><pre><span class="c">#  builds HDF5 specific test</span>
<span class="n">nxbuild</span> <span class="o">-</span><span class="n">o</span> <span class="n">napi_test</span><span class="o">-</span><span class="n">hdf5</span> <span class="n">napi_test</span><span class="o">.</span><span class="n">c</span>

<span class="c"># runs the test</span>
<span class="o">./</span><span class="n">napi_test</span><span class="o">-</span><span class="n">hdf5</span>
</pre></div>
</div>
<p>NeXus is also set up for pkg-config so the build can be done as:</p>
<div class="highlight-default"><div class="highlight"><pre>gcc `pkg-config --cflags` `pkg-config --libs` -o test test.c
</pre></div>
</div>
</div>
<div class="section" id="reporting-bugs-in-the-nexus-api">
<span id="napi-reporting"></span><h2>4.6. Reporting Bugs in the NeXus API<a class="headerlink" href="#reporting-bugs-in-the-nexus-api" title="Permalink to this headline">¶</a></h2>
<p>If you encounter any bugs in the installation or running of the NeXus API,
please report them online using our Issue Reporting system.
(<a class="reference external" href="http://wiki.nexusformat.org/IssueReporting">http://wiki.nexusformat.org/IssueReporting</a>)</p>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="napi-c.html" title="4.3.1. NAPI C and C++ Interface"
             >next</a> |</li>
        <li class="right" >
          <a href="classes/contributed_definitions/NXspin_rotator.html" title="3.3.3.12. NXspin_rotator"
             >previous</a> |</li>
        <li><a href="index.html">NeXus Home</a>&nbsp;|</li>
        <li><a href="contents.html">Table of Contents</a> &raquo;</li>
 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; <a href="copyright.html">Copyright</a> 1996-2016, http://nexusformat.org.
      Last updated on 2016-10-13 21:06:42 GMT+00:00.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.4.8.
    </div>
  </body>
</html>